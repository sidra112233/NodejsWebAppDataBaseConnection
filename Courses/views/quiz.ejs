<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #e1f5fe, #b3e5fc);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .header {
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            background-color: #87ceeb;
            color: #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 10px 20px;
            box-sizing: border-box;
            font-size: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }
        /* Navbar Styling */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #e3f2fd, #bbdefb, #90caf9); /* Light blue gradient */
    padding: 10px 20px;
    position: fixed;  /* Freezes the navbar */
    top: 0;
    left: 0;
    width: 100%;  /* Ensures the navbar spans the full width */
    z-index: 1000; /* Keeps the navbar on top of other content */
}

/* Navbar Left (Logo and Site Name) */
.navbar-left {
    display: flex;
    align-items: center;
}

.logo {
    height: 40px;
    width: 50px;
    margin-right: 10px;
}

.site-name {
    color: #1a237e; /* Deep blue for better contrast */
    font-size: 1.5em;
}

/* Navbar Right (Links and Buttons) */
.navbar-right a {
    color: #1a237e; /* Deep blue for better contrast */
    padding: 14px 20px;
    text-decoration: none;
    text-align: center;
}

.navbar-right a:hover {
    background-color: #82b1ff; /* Slightly darker blue hover effect */
}

.register-btn, .profile-btn, .signout-btn {
    border: 1px solid #1a237e; /* Deep blue border */
    border-radius: 5px;
    color: #1a237e; /* Deep blue text color */
}

/* Responsive Design */
@media screen and (max-width: 500px) {
    .navbar a {
        float: none;
        display: block;
    }
}

.sign-up-btn:hover, .profile-btn:hover, .sign-in-btn:hover {
    background-color: #e3f2fd; /* Light blue hover effect */
}

        .question-info {
            flex: 1;
            text-align: left;
        }

        .timer {
        flex:1;
            text-align: right;
        }

        .progress-container {
            width: 60%;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin: 0 20px;
        }

        .progress-bar {
            height: 20px;
            background-color: #0056b3;
            width: 0;
            transition: width 0.3s ease;
        }

        .quiz-container {
            display: flex;
            width: 85vw;
            height: 75vh;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            margin-top: 100px;
            margin-bottom: 10px;
            box-sizing: border-box;
            overflow: hidden;
        }

        .question-container,
        .options-container {
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .question-container {
            border-right: 2px solid #ddd;
            background-color: #f9f9f9;
            font-size: 1.4rem;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .options-container {
            background-color: #f4f4f4;
            font-size: 1.4rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 0;
        }

        .options-container label {
            font-size: 1.2rem;
            color: #555;
            display: flex;
            align-items: center;
            width: 100%;
            text-align: center;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            box-sizing: border-box;
            margin: 0;
        }
        .options-container input[type="radio"] {
            display: none;
        }

        .options-container .custom-radio {
            position: relative;
            display: flex;
            align-items: center;
            font-size: 1.1rem;
        }

        .options-container .custom-radio input[type="radio"] + span {
            position: relative;
            padding-left: 2.5rem;
            cursor: pointer;
        }

        .options-container .custom-radio input[type="radio"] + span::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 1.3em;
            height: 1.3em;
            border: 2px solid #555;
            border-radius: 50%;
            background: #fff;
            box-shadow: 0 0 0 3px #fff inset;
        }

        .options-container input[type="radio"]:checked + span::before {
            background: #87ceeb;
            box-shadow: 0 0 0 3px #fff inset;
        }

        .options-container input[type="radio"]:checked + span::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 0.5em;
            height: 0.5em;
            border-radius: 50%;
            background: #fff;
        }

        .next-btn, .back-btn {
            position: absolute;
            top: 20px;
            background-color: #007bff;
            color: #fff;
            border-radius: 12px;
            padding: 15px 30px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-style: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            z-index: 1001;
        }

        .next-btn {
            right: 20px;
        }

        .back-btn {
            left: 20px;
        }

        .next-btn:hover, .back-btn:hover {
            background-color: #0056b3;
        }

        .next-btn:focus, .back-btn:focus {
            outline: none;
        }
    </style>
<script>
    function startTimer(duration, display) {
        let timer = duration, minutes, seconds;
        const interval = setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                clearInterval(interval);
                let restart = confirm("Time is up! Do you want to restart the quiz?");
                if (restart) {
                    window.location.href = '/quiz/start/${quiz.quiz_id}${quiz.quiz_title}'
                } else {
                    window.location.href = '/dashboard';
                }
            }
        }, 1000);
    }

    window.onload = function () {
        let timeLeftInSeconds = <%= timeLeft %>;
        let display = document.querySelector('#time');
        startTimer(timeLeftInSeconds, display);
        updateProgress();
    };

    function updateProgress() {
        const currentIndex = <%= currentQuestionIndex %>;
        const totalQuestions = <%= totalQuestions %>;
        const progressPercentage = ((currentIndex ) / totalQuestions) * 100;
        document.querySelector('.progress-bar').style.width = progressPercentage + '%';
    }

    function handleNavigation(direction) {
        let form = document.querySelector('form');
        
        // Create a hidden input field to pass the action (next or back)
        let input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'action';
        input.value = direction;  // 'back' or 'next'
        form.appendChild(input);

        form.submit();  // Submit the form with the updated action
    }
</script>
</head>
<body>
  <nav class="navbar">
      <div class="navbar-left">
            <img src="/images/Logo.png" alt="Logo" class="logo">
            <span class="site-name">LEARN CODE PRO</span>
        </div>
        <div class="navbar-right">
<% if (student) { %>
    <a href="/profile"><%= student %></a>
    <a href="/dashboard">Dashboard</a>
    <a href="/sign-out">Sign Out</a>
<% } else { %>
    <a href="/sign-up">Sign Up</a>
    <a href="/sign-in">Sign In</a>
<% } %>
        </div>
    </nav>
    <div class="header">
        <div class="question-info">
            Question <%= currentQuestionIndex + 1 %> of <%= totalQuestions %>
        </div>
        <div class="progress-container">
            <div class="progress-bar" style="width: <%= ((currentQuestionIndex + 1) / totalQuestions) * 100 %>%;"></div>
        </div>
        <div class="timer">
            Time Left: <span id="time"></span>
        </div>
    </div>
    <form action="/next" method="POST">
        <input type="hidden" name="student_id" value="<%= student_id %>">
        <input type="hidden" name="currentQuestionId" value="<%= questions[currentQuestionIndex].question_id %>">

        <div class="quiz-container">
            <div class="question-container">
                <h3><%= questions[currentQuestionIndex].question_text %></h3>
            </div>
            <div class="options-container">
                <% questions[currentQuestionIndex].options.forEach((option, index) => { %>
                    <label class="custom-radio">
                        <input type="radio" name="answers[<%= questions[currentQuestionIndex].question_id %>]" value="<%= index + 1 %>" required>
                        <span><%= option %></span>
                    </label>
                <% }) %>
            </div>
            <div class="navigation-buttons">
                <% if (currentQuestionIndex > 0) { %>
                    <button class="back-btn" type="button" onclick="handleNavigation('back')">Back</button>
                <% } else { %>
                    <a class="back-btn" onclick="window.history.back()">&#8592; Back</a>
                <% } %>
                
                <button class="next-btn" type="submit" name="action" value="<%= currentQuestionIndex < totalQuestions - 1 ? 'next' : 'submit' %>">
                    <%= currentQuestionIndex < totalQuestions - 1 ? 'Next' : 'Submit' %>
                </button>
            </div>
        </div>
    </form>
</body>
</html>